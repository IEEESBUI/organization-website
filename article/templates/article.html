{% extends "base.html" %}
{% load static %}

{% block title %}Articles - IEEE SBUI{% endblock %}

{% block extra_css %}
<!-- Add this CSS for the featured article transition -->
<style>
  @font-face {
    font-family: "Helvetica Neue";
    src: url('{% static "fonts/HelveticaNeueHeavy_0.otf" %}') format("opentype");
    font-weight: 700;
    font-style: normal;
    font-display: swap;
  }
  @font-face {
    font-family: "Helvetica Neue";
    src: url('{% static "fonts/HelveticaNeueLight_0.otf" %}') format("opentype");
    font-weight: 300;
    font-style: normal;
    font-display: swap;
  }

  @keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
  }

  .animate-on-scroll {
      opacity: 0;
  }

  .animate-fade-in-up {
      animation: fadeInUp 0.6s ease-out forwards;
  }

  .delay-100 {
      animation-delay: 100ms;
  }
  .delay-200 {
      animation-delay: 200ms;
  }
  .delay-300 {
      animation-delay: 300ms;
  }
  .delay-400 {
      animation-delay: 400ms;
  }

  /* Apply Helvetica Neue globally */
  body {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-weight: 300; /* Default to Light */
  }

  h1, h2, h3, h4, h5, h6, .custom-text-gradient {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-weight: 700; /* Heavy for headings */
  }

  /* Ensure all other elements inherit the font-family */
  * {
    font-family: inherit;
  }

  /* Dropdown styles */
  .dropdown {
    position: relative;
    display: inline-block;
  }

  .dropdown-content {
    display: none;
    position: absolute;
    right: 0;
    background-color: white;
    min-width: 200px;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
    z-index: 1;
    border-radius: 0.5rem;
    margin-top: 0.5rem;
  }

  .dropdown-content.show {
    display: block;
  }

  .dropdown-item {
    padding: 12px 16px;
    text-decoration: none;
    display: block;
    color: black;
    cursor: pointer;
  }

  .dropdown-item:hover {
    background-color: #f1f1f1;
  }

  .dropdown-label {
    padding: 12px 16px;
    font-weight: bold;
    border-bottom: 1px solid #e2e8f0;
  }

  .dropdown-separator {
    height: 1px;
    background-color: #e2e8f0;
    margin: 4px 0;
  }

  .checkbox-item {
    display: flex;
    align-items: center;
  }

  .checkbox-item input {
    margin-right: 8px;
  }

  /* Active filter badge */
  .filter-badge {
    display: inline-flex;
    align-items: center;
    background-color: #f3f4f6;
    padding: 0.25rem 0.75rem;
    border-radius: 9999px;
    margin-right: 0.5rem;
    margin-bottom: 0.5rem;
    font-size: 0.875rem;
  }

  .filter-badge button {
    margin-left: 0.5rem;
    color: #6b7280;
  }

  .filter-badge button:hover {
    color: #ef4444;
  }

  /* Featured article styles */
  .featured-article {
    border: 1px solid #e2e8f0;
    border-radius: 0.5rem;
    overflow: hidden;
  }

  /* Featured article transition */
  #featuredArticleSection {
    opacity: 1;
    max-height: 1000px; /* Adjust based on your content */
    transition: opacity 0.3s ease-out, max-height 0.3s ease-out;
    overflow: hidden;
  }

  #featuredArticleSection.featured-hidden {
    opacity: 0;
    max-height: 0;
  }

  /* Article card styles */
  .article-card {
    transition: transform 0.2s ease-in-out;
  }

  .article-card:hover {
    transform: translateY(-5px);
  }

  /* Pagination styles */
  .pagination-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background-color: #d1d5db;
    cursor: pointer;
  }

  .pagination-dot.active {
    background-color: #f32929;
  }
</style>
{% endblock %}

{% block content %}
<!-- Hero Section -->
 {% comment %} TODO: BIKIN DIAMOND GRADIENT {% endcomment %}
<section class="bg-gradient-to-r from-blue-900 via-[#f32929] to-blue-900 py-32 text-center">
  <h1 class="text-4xl md:text-5xl font-bold text-white mb-4 animate-on-scroll delay-400">Articles</h1>
  <p class="text-white max-w-xl mx-auto px-4 animate-on-scroll delay-400">
    Stay updated with the latest news, insights, and technological advancements
  </p>
</section>

<!-- Search and Filter Section -->
<section class="py-8 px-6 max-w-6xl mx-auto w-full">
  <div class="flex flex-col md:flex-row gap-4 items-center">
    <div class="relative flex-1 w-full">
      <form method="GET" action="{% url 'articles' %}" id="searchForm">
        <input
          type="text"
          name="search"
          placeholder="Search articles..."
          value="{{ request.GET.search|default:'' }}"
          class="w-full px-4 py-3 rounded-full border border-gray-300 focus:outline-none focus:ring-2 focus:ring-[#f32929]"
        >
      </form>
    </div>
    <div class="flex gap-2">
      <!-- Filter Dropdown -->
      <div class="dropdown" id="filterDropdown">
        <button class="px-6 py-2 rounded-full border border-gray-300 hover:bg-gray-100 flex items-center" id="filterButton">
          Filter
        </button>
        <div class="dropdown-content" id="filterContent">
          <div class="dropdown-label">Sort By</div>
          <div class="dropdown-separator"></div>
          <div class="dropdown-item radio-item" data-value="recent" data-filter-type="sort">Most Recent</div>
          <div class="dropdown-item radio-item" data-value="popular" data-filter-type="sort">Most Popular</div>
          <div class="dropdown-item radio-item" data-value="oldest" data-filter-type="sort">Oldest First</div>
          <div class="dropdown-item radio-item" data-value="az" data-filter-type="sort">A-Z</div>
          <div class="dropdown-item radio-item" data-value="za" data-filter-type="sort">Z-A</div>
        </div>
      </div>

      <!-- Categories Dropdown -->
      <div class="dropdown" id="categoryDropdown">
        <button class="px-6 py-2 rounded-full border border-gray-300 hover:bg-gray-100 flex items-center" id="categoryButton">
          Categories
        </button>
        <div class="dropdown-content" id="categoryContent">
          <div class="dropdown-label">Select Category</div>
          <div class="dropdown-separator"></div>
          {% for category in categories %}
          <div class="dropdown-item checkbox-item">
            <input type="checkbox" id="category-{{ category.id }}" name="category" value="{{ category.id }}" 
              {% if category.id|stringformat:"i" in selected_categories %}checked{% endif %}>
            <label for="category-{{ category.id }}">{{ category.name }}</label>
          </div>
          {% endfor %}
          {% comment %} <div class="dropdown-separator"></div>
          <div class="dropdown-item text-center text-sm view-all-articles">View All Articles</div> {% endcomment %}
        </div>
      </div>
    </div>
  </div>

  <!-- Active Filters Display -->
  <div class="mt-4" id="activeFilters">
    {% include "partials/active_filters.html" %}
  </div>
</section>

<!-- Featured Articles -->
<section class="py-8 px-6 max-w-6xl mx-auto w-full" id="featuredArticleSection" {% if has_search_or_filter %}class="featured-hidden" style="display: none;"{% endif %}>
  <div class="text-center mb-6 ">
    <h2 class="text-3xl md:text-4xl font-bold mb-2 animate-on-scroll delay-400">
      <span class="text-purple-800">Featured</span> <span class="text-[#f32929]">Articles</span>
    </h2>
    <p class="text-gray-600 animate-on-scroll delay-400">Highlighted articles from our contributors</p>
  </div>

  {% if featured_article %}
  <div class="featured-article p-6 mb-12 animate-on-scroll delay-400">
    <div class="flex flex-col md:flex-row gap-6">
      <div class="md:w-1/4">
        <div class="relative w-full aspect-square rounded-lg overflow-hidden">
          {% if featured_article.image %}
          <img src="{{ featured_article.image.url }}" alt="{{ featured_article.title }}" class="object-cover w-full h-full">
          {% else %}
          <img src="{% static 'images/IEEE-Logo-Round.png' %}" alt="Placeholder" class="object-cover w-full h-full">
          {% endif %}
        </div>
      </div>
      <div class="md:w-3/4">
        <div class="text-sm text-gray-600 mb-1">
          {{ featured_article.created_at|date:"F d, Y" }} | 
          {% for category in featured_article.categories.all %}
            {{ category.name }}{% if not forloop.last %}, {% endif %}
          {% endfor %}
        </div>
        <h3 class="text-2xl font-bold mb-2">{{ featured_article.title }}</h3>
        <p class="text-gray-600 mb-4">{{ featured_article.excerpt }}</p>
        <div class="flex justify-between items-center">
          <div class="text-sm">By {{ featured_article.author.get_full_name|default:featured_article.author.username }}</div>
          <a href="{% url 'article_detail' featured_article.slug %}" class="bg-[#f32929] text-white px-4 py-2 rounded-full text-sm hover:bg-red-600">
            Click For More
          </a>
        </div>
      </div>
    </div>
  </div>
  {% endif %}
</section>

<!-- Latest Articles -->
<section class="py-8 px-6 max-w-6xl mx-auto w-full">
  <div class="flex justify-between items-center mb-6 animate-on-scroll delay-400" >
    <div>
      <h2 class="text-3xl md:text-4xl font-bold mb-2">
        <span class="text-purple-800">Latest</span> <span class="text-[#f32929]" >Articles</span>
      </h2>
      <p class="text-gray-600">Stay updated with our most recent publications</p>
    </div>
    <button type="button" class="block border border-gray-300 px-4 py-2 rounded-full text-sm hover:bg-gray-100 transition-colors view-all-articles">
      {% if has_search_or_filter or not featured_article %}View All Articles{% else %}Hide Featured{% endif %}
    </button>
  </div>

  <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8" id="articlesContainer">
    {% include "partials/article_list.html" %}
  </div>

  <!-- Pagination -->
  <div class="pagination-container">
    {% include "partials/pagination.html" %}
  </div>
</section>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/article-ajax.js' %}"></script>
{% endblock %}
